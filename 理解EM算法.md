# 											理解EM算法

## 最大似然估计：估计模型参数的统计学方法

​	已知 1）样本服从分布的模型；2）观测到的样本

求解：模型的参数

eg：100名同学身高问题：

​			1)样本集：
$$
\begin{aligned}
X=\{x_1,x_2,...,x_n\},n=100\end{aligned}
$$
​			2)概率密度：
$$
P(x_i|\theta)为抽到的学生i的（身高）概率\\
\theta服从分布的参数
$$
​			3)独立同分布：同时抽到这100名同学的概率就是他们各自概率的乘积

​			4)最大似然函数：(对数是为了乘法转加法)，参数估计通过若干次的实验，观察其结果，利用结果推导出参数的最大概率
$$
l(\theta)=log(\prod_{i=0}^nP(x_i;\theta))=\sum_{i=1}^{n}logP(x_i;\theta)
$$


## 引入隐变量

问题描述：在前基础上，添加男生女生的条件，其中男生女生的身高都服从高斯分布，但是参数不同（均值、方差）；求解目标：男生女生分别对应的高斯分布的参数是多少？

加入隐变量Z=1或Z=0标记样本来自于哪一个分布，因此可以将上面的最大似然函数写为：
$$
l(\theta)=\sum_{i=1}^{m}logP(x_i|\theta)\\=\sum_{i=1}^{m}log\sum_{z}p(x_i,z;\theta)
$$
使用给定的初始值情况下进行迭代求解

## 算法求解实例

**步骤一：**假设：硬币A正面的概率为P(正|A)=0.6  硬币B正面的概率为P(正|B)=0.5

**步骤二** ：E-Step

| 选择Coin A概率 | 选择Coin B概率 | CoinA期望（H：正  T反） | CoinB期望（H：正  T反） | 正/反 |
| -------------- | -------------- | ----------------------- | ----------------------- | ----- |
| 0.45           | 0.55           | 2.2H 2.2T               | 2.75H 2.75T             | 5/5   |
| 0.8            | 0.2            | 7.2H 0.8T               | 1.8H 0.2T               | 9/1   |
| 0.73           | 0.27           | 5.84H 0.146T            | 2.16H 0.54T             | 8/2   |
| 0.35           | 0.65           | 1.4H 2.1T               | 2.6H 3.9T               | 4/6   |
| 0.65           | 0.35           | 4.55H 1.95T             | 2.45H 1.05T             | 7/3   |
| 累加           |                | 约等于21.3H，8.6T       | 约等于11.7H，8.4T       |       |


$$
投掷5正5反的概率:P(A)=C^{5}_{10}\times 0.6^5\times 0.4^5\\
P(B)=C^{5}_{10}\times 0.5^5\times 0.5^5\\
上述期望计算公式：E(选择A且正面)=P(select_A)\times times_H\\
E(选择A且反面)=P(select_A)\times times_T
$$
**步骤三**：M-Step更新之前假设的P(正|A)  硬币B正面的概率为P(正|B)
$$
\theta{_A}^{(1)}\approx\frac{21.3}{21.3+8.4}\approx0.71\\
\theta{_B}^{(1)}\approx\frac{11.7}{11.7+8.4}\approx0.58\\
P(正|A)\approx0.71 \\P(正|B)\approx0.58\\
P(A)=C^{5}_{10}\times 0.71^5\times 0.29^5\\
P(B)=C^{5}_{10}\times 0.58^5\times 0.42^5\\
$$
在迭代一定次数后P(正|A) 、P(正|B)会趋于收敛

